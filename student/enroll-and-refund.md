# 新生报名，老生续费和退费

## 新生报名表

| 报名ID | 学号 | 报名学期 | 课程 | 应交学费 | 实际学费 | 班级 | 经办人 | 时间 | 备注 |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| B01 | 01 | 2019年秋季学期 | 一年级绘画课程 | 3250 | 2950 | 一年级（2）班 | 张老师 | 2019/06/05 11:00 | 减免300 |
| B02 | 02 | 2019年秋季学期 | 国画 | 3250 | 3250 | 国画（1）班 | 王老师 | 2019/06/05 11:00 | |

* 新生报名时的班级
  * 需要已经创建好课程下的一个班级
  * 该班级需要确定每次上课的时间（周期性/非周期性）
  * 班级的任课老师可以待定
  * 班级的每次上课的教室可以待定

## 续费
* 当前学期在学校的某个课程的一个班级就读的学生，希望下学期在当前课程的下学期的后续课程继续学习，缴纳了学费。

## 如何确定下学期的后续课程以及学费
   * 如果当前课程在升迁链上，那么下学期的后续课程就是当前课程在升迁链上的下一个节点
   * 如果当前课程不在任何升迁链上，那么下学期的后续课程就是**当前课程**

## 续费表

| 续费ID | 学期 | 续费班级 | 本学期课程 | 下学期课程 | 续费应付金额 | 续费实际金额 | 学生姓名 | 学生证件类型 | 学生证件号码 | 联系电话 |  备注 |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| X01 | 2019年秋季学期 | 一年级（1）班 | 一年级绘画课程 | 二年级绘画课程 | 3200 | 3200 | 小明 | 身份证 | 31010420120101 | 13600136000 | |
| X02 | 2019年秋季学期 | 国画（1）班 | 国画 | 国画  | 3200 | 3200 |  小明 | 身份证 | 31010420120101 | 13600136000 | |
| X03 | 2019年秋季学期 | 二年级（3）班 | 二年级绘画课程 | 三年级绘画课程  | 3200 | 2900 | 小红 | 身份证 | 31010420110202 | 13800138000 | 减免300 |
| X04 | 2019年秋季学期 | 三年级（5）班 | 三年级绘画课程 | 四年级绘画课程 | 3200 | 0 | 小刚 | 身份证 | 31010420100303 | 13500135000 | VIP全免，现金0元续费 |

## 续费表的创建/更新
* 一个学期可以为所有课程的班级中的所有学生创建一张续费表
* 在续费正式开始前，可以根据班级中的学生的动态情况的变化（新报名/学费/证件号修改/优惠券发放），更新续费表
* 创建/更新的触发方式
  * 人为手动在某个时间，进行触发（比如点击按钮）

## 续费结果表

| 续费结果ID | 续费ID | 支付状态 | 支付方式 | 网络支付流水号 | 现金收费员工 | 支付时间 | 备注 |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | 
| R01 | X01 | 待支付 | | n/a | n/a | n/a | n/a |
| R02 | X02 | 已支付 | 网络支付 | L0001 | n/a | 2019/11/15 10:00  | n/a |
| R03 | X03 | 已支付 | 现金支付 |  n/a | 张老师 | 2019/11/16 20:00 | 减免300 |
| R04 | X04 | 已支付 | 现金支付 |  n/a | 王老师  | 2019/11/17 21:00 | VIP，0元现金支付 |

## 判断1个班级中的学生的来源

| 来源种类 | 操作流程 | 备注 |
| :--: | :--: | :--: |
| 老生续费报名 | 在当前学期的续费周期内，学生续费后，可以在续费结果表中找到记录，比如续费ID，选择续费ID，与班级关联。将学生转入下学期的1个虚拟班/实体班 | 续费ID和班级ID，学生ID关联 |  
| 学期中转班 | 学期进行中，该班级至少上了1次课，将学生从某个班级，转入到另一个班级 | 可以考虑增加一个列，保存学期中转班的学生的前一个班级的信息。学生可以有一个单独的表，用来追踪转班历史班级列表 |
| 新生报名 | 新生在某个班级报名，和上课次数无关 | |

## 新生和老生
* 定义
  * 学生不是通过续费方式报名一个课程的一个班级，该学生就是该班级的新生，反之就是该班级的老生
* 新生和老生是基于班级角度的
  * 同一个课程的2个班级，如果学生都报名了，则该学生可以是A班的老生，也可以是B班的新生（极端情况）

## 退费
* 退费类型和保留率的关系

  | 退费类型 | 是否影响上学期保留率 |
  | :--: | :--: |
  | 新生**全额**退费 | 否 |
  | 新生**部分**退费 | 否 |
  | 老生续费**全额**退费 | 是 |
  | 老生续费**部分**退费 | 否 |

## 退费表

| 退费ID | 退费类型 | 退费方式 | 退费金额 | 退费状态 | 续费结果ID | 新生报名ID | 退费经办员工 | 时间 |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| T01 | 老生续费全额退费 | 网络支付原路径退费 | 3200 | 退费申请已经提交，等待银行处理 | R01 | n/a | 张老师 | 2019/11/16 09:00 | |
| T02 | 老生续费部分退费 | 网络支付原路径退费 | 2000 | 银行处理完成 | R02 | n/a | 张老师 | 2019/11/16 09:00 | |
| T03 | 新生报名全额退费 | 现金退费 | 3250 | 现金退费完成 | n/a | B01 | 王老师 | 2019/11/17 10:00 | |
